spring.application.name=dosa_backend

# Load local .env as a properties source (optional)
# spring.config.import=optional:file:.env.local[.properties]

server.port=${SERVER_PORT:8080}

# PostgreSQL
spring.datasource.url=${DB_URL:}
spring.datasource.username=${DB_USER:}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# Storage
app.storage.base-dir=${STORAGE_DIR:./storage}


# OpenAI (NEVER hardcode keys here)
openai.api-key=${OPENAI_API_KEY:}
openai.base-url=${OPENAI_BASE_URL:https://api.openai.com/v1}

# Models
openai.chat-model=${OPENAI_CHAT_MODEL:gpt-5-mini}
openai.embedding-model=${OPENAI_EMBEDDING_MODEL:text-embedding-3-small}

# Optional: shrink embeddings dimension to reduce DB size (0 = provider default)
openai.embedding-dimensions=${OPENAI_EMBEDDING_DIMENSIONS:0}

# Responses API token budgets
# - 크게 잡으면 incomplete(max_output_tokens) 재시도가 줄어듦
# - 대신 응답 지연/비용이 증가할 수 있으니 운영환경에서는 관측 후 조정 권장
openai.responses.max-output-tokens=${OPENAI_RESPONSES_MAX_OUTPUT_TOKENS:8000}
openai.responses.retry-max-output-tokens=${OPENAI_RESPONSES_RETRY_MAX_OUTPUT_TOKENS:16000}

# Reasoning effort: low/medium/high (서비스 요구에 맞게)
openai.responses.reasoning-effort=${OPENAI_RESPONSES_REASONING_EFFORT:low}

# (옵션) Chat Completions API를 쓰는 코드가 남아있다면 유지
openai.chat.max-completion-tokens=${OPENAI_CHAT_MAX_COMPLETION_TOKENS:8000}

# Chat system prompts (wired from .env)
app.chat.root-system-prompt=${APP_CHAT_ROOT_SYSTEM_PROMPT:당신은 과학/공학 학습용 3D 뷰어 서비스의 AI 튜터입니다.}
app.chat.model-system-prompts.v4_engine=${APP_CHAT_MODEL_V4_ENGINE_SYSTEM_PROMPT:V4 엔진 조립 모델의 동작 원리와 부품 간 상호작용을 기계공학 관점에서 설명하세요. 회전 운동, 왕복 운동, 토크 전달 흐름을 우선적으로 다루세요.}
app.chat.model-system-prompts.suspension=${APP_CHAT_MODEL_SUSPENSION_SYSTEM_PROMPT:서스펜션 모델의 핵심 기능(충격 흡수, 접지력 유지, 승차감)을 중심으로 설명하세요. 하중 변화와 감쇠 특성을 학습자 눈높이로 풀어주세요.}
app.chat.model-system-prompts.robot_gripper=${APP_CHAT_MODEL_ROBOT_GRIPPER_SYSTEM_PROMPT:로봇 그리퍼 모델의 파지 원리(힘 전달, 접촉면, 마찰)를 중심으로 설명하세요. 물체 특성에 따른 파지 전략 차이를 함께 안내하세요.}
app.chat.model-system-prompts.drone=${APP_CHAT_MODEL_DRONE_SYSTEM_PROMPT:드론 모델의 비행 안정화 원리(추력, 자세 제어, 모터 밸런스)를 중심으로 설명하세요. 프로펠러/모터/프레임의 역할을 명확히 구분해 주세요.}
app.chat.model-system-prompts.robot_arm=${APP_CHAT_MODEL_ROBOT_ARM_SYSTEM_PROMPT:로봇 암 모델의 관절 구조, 자유도, 작업 좌표계 개념을 중심으로 설명하세요. 링크-조인트 체인의 운동학적 관점을 우선적으로 다루세요.}

# swagger
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.operations-sorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.packages-to-scan=com.test.dosa_backend.controller

# Logging
logging.level.org.hibernate.SQL=INFO
